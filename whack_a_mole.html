<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ æ‰“åœ°é¼ æ¸¸æˆ - Whack-A-Mole</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
        }

        .game-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .home-btn {
            position: absolute;
            top: 0;
            left: 0;
            background: linear-gradient(135deg, #ffd700, #ffaa00);
            color: #333;
            padding: 10px 20px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: bold;
            font-size: 13px;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
        }

        .home-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }

        .game-title {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .game-subtitle {
            font-size: 18px;
            color: #666;
        }

        .stats-panel {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            text-align: center;
            min-width: 150px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .hole {
            position: relative;
            height: 150px;
            background: linear-gradient(180deg, #8B4513 0%, #654321 100%);
            border-radius: 50% 50% 0 0;
            overflow: hidden;
            cursor: pointer;
            box-shadow: inset 0 -5px 10px rgba(0,0,0,0.3);
        }

        .mole {
            position: absolute;
            bottom: -100%;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 80%;
            background: #8B4513;
            border-radius: 50% 50% 0 0;
            transition: bottom 0.2s ease-out;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 10px;
        }

        .mole.show {
            bottom: 0;
        }

        .mole.hit {
            animation: hit 0.3s ease-out;
        }

        @keyframes hit {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(0.8); }
        }

        .mole-face {
            font-size: 60px;
            user-select: none;
        }

        .mole-eyes {
            font-size: 20px;
            margin-top: -10px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-start {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .btn-start:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(0,0,0,0.3);
        }

        .btn-start:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-pause {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-pause:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(0,0,0,0.3);
        }

        .btn-reset {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(0,0,0,0.3);
        }

        .difficulty-selector {
            text-align: center;
            margin-bottom: 20px;
        }

        .difficulty-selector label {
            font-size: 16px;
            color: #666;
            margin-right: 10px;
        }

        .difficulty-selector select {
            padding: 10px 20px;
            font-size: 16px;
            border: 2px solid #667eea;
            border-radius: 8px;
            background: white;
            cursor: pointer;
        }

        .game-over {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .game-over.show {
            display: flex;
        }

        .game-over-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 400px;
        }

        .game-over-title {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 20px;
        }

        .game-over-score {
            font-size: 24px;
            color: #666;
            margin-bottom: 30px;
        }

        .score-popup {
            position: absolute;
            font-size: 24px;
            font-weight: bold;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: scoreFloat 1s ease-out forwards;
            pointer-events: none;
            z-index: 100;
        }

        @keyframes scoreFloat {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px);
            }
        }

        .best-score {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            margin-top: 10px;
            font-size: 16px;
        }

        @media (max-width: 600px) {
            .game-board {
                grid-template-columns: repeat(2, 1fr);
            }

            .hole {
                height: 120px;
            }

            .mole-face {
                font-size: 40px;
            }

            .game-title {
                font-size: 32px;
            }

            .stat-box {
                min-width: 120px;
                padding: 10px 20px;
            }

            .stat-value {
                font-size: 24px;
            }
        }

        .combo-indicator {
            text-align: center;
            margin-bottom: 15px;
            font-size: 24px;
            font-weight: bold;
            color: #ff6b6b;
            min-height: 30px;
            animation: pulse 0.5s ease-in-out;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <a href="index.html" class="home-btn">ğŸ  è¿”å›å¯¼èˆªä¸­å¿ƒ</a>
            <h1 class="game-title">ğŸ¯ æ‰“åœ°é¼ </h1>
            <p class="game-subtitle">å¿«é€Ÿç‚¹å‡»åœ°é¼ ï¼Œè·å¾—é«˜åˆ†ï¼</p>
        </div>

        <div class="difficulty-selector">
            <label for="difficulty">é€‰æ‹©éš¾åº¦ï¼š</label>
            <select id="difficulty">
                <option value="easy">ç®€å• (æ…¢é€Ÿ)</option>
                <option value="normal" selected>æ™®é€š (ä¸­é€Ÿ)</option>
                <option value="hard">å›°éš¾ (å¿«é€Ÿ)</option>
                <option value="expert">ä¸“å®¶ (æé€Ÿ)</option>
            </select>
        </div>

        <div class="stats-panel">
            <div class="stat-box">
                <div class="stat-label">å¾—åˆ†</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">æ—¶é—´</div>
                <div class="stat-value" id="time">60</div>
            </div>
            <div class="stat-box">
                <div class="stat-label">è¿å‡»</div>
                <div class="stat-value" id="combo">0</div>
            </div>
        </div>

        <div class="combo-indicator" id="comboText"></div>

        <div class="game-board" id="gameBoard">
            <!-- 9ä¸ªåœ°é¼ æ´ -->
        </div>

        <div class="controls">
            <button class="btn btn-start" id="startBtn">å¼€å§‹æ¸¸æˆ</button>
            <button class="btn btn-pause" id="pauseBtn" disabled>æš‚åœ</button>
            <button class="btn btn-reset" id="resetBtn">é‡ç½®</button>
        </div>
    </div>

    <div class="game-over" id="gameOver">
        <div class="game-over-content">
            <div class="game-over-title">ğŸ‰ æ¸¸æˆç»“æŸ!</div>
            <div class="game-over-score">
                æœ€ç»ˆå¾—åˆ†: <span id="finalScore">0</span>åˆ†<br>
                æœ€é«˜è¿å‡»: <span id="maxCombo">0</span>è¿å‡»
            </div>
            <div class="best-score">
                å†å²æœ€é«˜: <span id="bestScore">0</span>åˆ†
            </div>
            <button class="btn btn-start" onclick="closeGameOver()">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        let score = 0;
        let timeLeft = 60;
        let combo = 0;
        let maxCombo = 0;
        let gameActive = false;
        let gamePaused = false;
        let gameTimer = null;
        let moleTimer = null;
        let currentMole = null;
        let bestScore = localStorage.getItem('mole_best_score') || 0;

        // éš¾åº¦è®¾ç½®
        const difficultySettings = {
            easy: { moleSpeed: 1500, showTime: 2000 },
            normal: { moleSpeed: 1000, showTime: 1500 },
            hard: { moleSpeed: 700, showTime: 1000 },
            expert: { moleSpeed: 500, showTime: 800 }
        };

        // DOM å…ƒç´ 
        const gameBoard = document.getElementById('gameBoard');
        const scoreDisplay = document.getElementById('score');
        const timeDisplay = document.getElementById('time');
        const comboDisplay = document.getElementById('combo');
        const comboText = document.getElementById('comboText');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const difficultySelect = document.getElementById('difficulty');
        const gameOverDiv = document.getElementById('gameOver');
        const finalScoreDisplay = document.getElementById('finalScore');
        const maxComboDisplay = document.getElementById('maxCombo');
        const bestScoreDisplay = document.getElementById('bestScore');

        // åˆå§‹åŒ–æ¸¸æˆæ¿
        function initBoard() {
            gameBoard.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const hole = document.createElement('div');
                hole.className = 'hole';
                hole.dataset.index = i;
                
                const mole = document.createElement('div');
                mole.className = 'mole';
                
                const face = document.createElement('div');
                face.className = 'mole-face';
                face.textContent = 'ğŸ­';
                
                const eyes = document.createElement('div');
                eyes.className = 'mole-eyes';
                eyes.textContent = 'â€¢ â€¢';
                
                mole.appendChild(face);
                mole.appendChild(eyes);
                hole.appendChild(mole);
                
                hole.addEventListener('click', () => hitMole(hole));
                
                gameBoard.appendChild(hole);
            }
        }

        // éšæœºæ˜¾ç¤ºåœ°é¼ 
        function showRandomMole() {
            if (!gameActive || gamePaused) return;

            // éšè—å½“å‰åœ°é¼ 
            if (currentMole) {
                currentMole.querySelector('.mole').classList.remove('show');
            }

            // éšæœºé€‰æ‹©æ–°åœ°é¼ 
            const holes = document.querySelectorAll('.hole');
            const randomIndex = Math.floor(Math.random() * holes.length);
            currentMole = holes[randomIndex];
            
            const mole = currentMole.querySelector('.mole');
            mole.classList.add('show');

            // è·å–å½“å‰éš¾åº¦è®¾ç½®
            const difficulty = difficultySelect.value;
            const settings = difficultySettings[difficulty];

            // è®¾ç½®åœ°é¼ è‡ªåŠ¨éšè—
            setTimeout(() => {
                if (mole.classList.contains('show')) {
                    mole.classList.remove('show');
                    combo = 0;
                    updateComboDisplay();
                }
            }, settings.showTime);

            // è®¾ç½®ä¸‹ä¸€ä¸ªåœ°é¼ 
            moleTimer = setTimeout(showRandomMole, settings.moleSpeed);
        }

        // å‡»ä¸­åœ°é¼ 
        function hitMole(hole) {
            if (!gameActive || gamePaused) return;

            const mole = hole.querySelector('.mole');
            if (!mole.classList.contains('show')) return;

            // æ’­æ”¾å‡»ä¸­åŠ¨ç”»
            mole.classList.add('hit');
            setTimeout(() => mole.classList.remove('hit'), 300);

            // éšè—åœ°é¼ 
            mole.classList.remove('show');

            // æ›´æ–°è¿å‡»
            combo++;
            if (combo > maxCombo) maxCombo = combo;

            // è®¡ç®—å¾—åˆ†ï¼ˆè¿å‡»æœ‰é¢å¤–å¥–åŠ±ï¼‰
            const points = 10 + (combo > 1 ? combo * 5 : 0);
            score += points;

            // æ˜¾ç¤ºå¾—åˆ†åŠ¨ç”»
            showScorePopup(hole, `+${points}`);

            // æ›´æ–°æ˜¾ç¤º
            scoreDisplay.textContent = score;
            comboDisplay.textContent = combo;
            updateComboDisplay();

            // æ’­æ”¾éŸ³æ•ˆï¼ˆä½¿ç”¨Web Audio APIï¼‰
            playHitSound();
        }

        // æ›´æ–°è¿å‡»æ˜¾ç¤º
        function updateComboDisplay() {
            if (combo >= 5) {
                comboText.textContent = `ğŸ”¥ ${combo}è¿å‡»! å¤ªæ£’äº†! ğŸ”¥`;
                comboText.style.color = '#ff6b6b';
            } else if (combo >= 3) {
                comboText.textContent = `âš¡ ${combo}è¿å‡»! âš¡`;
                comboText.style.color = '#ffa500';
            } else {
                comboText.textContent = '';
            }
        }

        // æ˜¾ç¤ºå¾—åˆ†å¼¹å‡º
        function showScorePopup(hole, text) {
            const popup = document.createElement('div');
            popup.className = 'score-popup';
            popup.textContent = text;
            
            const rect = hole.getBoundingClientRect();
            popup.style.left = `${rect.left + rect.width / 2}px`;
            popup.style.top = `${rect.top}px`;
            
            document.body.appendChild(popup);
            
            setTimeout(() => popup.remove(), 1000);
        }

        // æ’­æ”¾å‡»ä¸­éŸ³æ•ˆ
        function playHitSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }

        // å¼€å§‹æ¸¸æˆ
        function startGame() {
            if (gameActive && !gamePaused) return;

            if (!gameActive) {
                // å…¨æ–°å¼€å§‹
                score = 0;
                timeLeft = 60;
                combo = 0;
                maxCombo = 0;
                scoreDisplay.textContent = score;
                timeDisplay.textContent = timeLeft;
                comboDisplay.textContent = combo;
                comboText.textContent = '';
            }

            gameActive = true;
            gamePaused = false;
            startBtn.disabled = true;
            pauseBtn.disabled = false;
            difficultySelect.disabled = true;

            // å¼€å§‹è®¡æ—¶
            gameTimer = setInterval(() => {
                if (!gamePaused) {
                    timeLeft--;
                    timeDisplay.textContent = timeLeft;

                    if (timeLeft <= 0) {
                        endGame();
                    }
                }
            }, 1000);

            // å¼€å§‹æ˜¾ç¤ºåœ°é¼ 
            showRandomMole();
        }

        // æš‚åœ/ç»§ç»­æ¸¸æˆ
        function togglePause() {
            gamePaused = !gamePaused;
            pauseBtn.textContent = gamePaused ? 'ç»§ç»­' : 'æš‚åœ';

            if (!gamePaused) {
                showRandomMole();
            } else {
                clearTimeout(moleTimer);
            }
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            gameActive = false;
            gamePaused = false;
            clearInterval(gameTimer);
            clearTimeout(moleTimer);

            score = 0;
            timeLeft = 60;
            combo = 0;
            maxCombo = 0;

            scoreDisplay.textContent = score;
            timeDisplay.textContent = timeLeft;
            comboDisplay.textContent = combo;
            comboText.textContent = '';

            startBtn.disabled = false;
            pauseBtn.disabled = true;
            pauseBtn.textContent = 'æš‚åœ';
            difficultySelect.disabled = false;

            // éšè—æ‰€æœ‰åœ°é¼ 
            document.querySelectorAll('.mole').forEach(mole => {
                mole.classList.remove('show');
            });
        }

        // ç»“æŸæ¸¸æˆ
        function endGame() {
            gameActive = false;
            clearInterval(gameTimer);
            clearTimeout(moleTimer);

            // æ›´æ–°æœ€é«˜åˆ†
            if (score > bestScore) {
                bestScore = score;
                localStorage.setItem('mole_best_score', bestScore);
            }

            // æ˜¾ç¤ºæ¸¸æˆç»“æŸç•Œé¢
            finalScoreDisplay.textContent = score;
            maxComboDisplay.textContent = maxCombo;
            bestScoreDisplay.textContent = bestScore;
            gameOverDiv.classList.add('show');

            // éšè—æ‰€æœ‰åœ°é¼ 
            document.querySelectorAll('.mole').forEach(mole => {
                mole.classList.remove('show');
            });
        }

        // å…³é—­æ¸¸æˆç»“æŸç•Œé¢
        function closeGameOver() {
            gameOverDiv.classList.remove('show');
            resetGame();
        }

        // äº‹ä»¶ç›‘å¬
        startBtn.addEventListener('click', startGame);
        pauseBtn.addEventListener('click', togglePause);
        resetBtn.addEventListener('click', resetGame);

        // åˆå§‹åŒ–
        initBoard();
        bestScoreDisplay.textContent = bestScore;

        // é”®ç›˜æ”¯æŒï¼ˆæ•°å­—é”®1-9æ‰“åœ°é¼ ï¼‰
        document.addEventListener('keydown', (e) => {
            if (!gameActive || gamePaused) return;
            
            const key = parseInt(e.key);
            if (key >= 1 && key <= 9) {
                const holes = document.querySelectorAll('.hole');
                hitMole(holes[key - 1]);
            }
        });
    </script>
</body>
</html>
